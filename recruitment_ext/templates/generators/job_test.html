{% extends "templates/web.html" %}
<!-- TODO: redirect if 'job_applicant' is None -->
{% block style %}
<link rel="stylesheet" href="/assets/css/desk.min.css">
<style>
	.job-test-form-wrapper .section-body{
		flex-direction: column;
		width: auto;
		padding: 0 1rem;
	}
</style>
{% endblock %}

 {% macro make_input(question) %}
		<div class="frappe-control input-max-width">
			<div class="form-group">
				<div class="control-input-wrapper">
					<div class="control-input">
						{% if question.question_type == 'Answer' %}
							<input type="text" class="form-control bold" placeholder="{{ question.placeholder_text or '' }}" autocomplete="off" name="{{ question.name }}" data-fieldname="{{ question.name }}" data-question-type="{{ question.question_type }}">
						{% elif question.question_type == 'Long Answer' %}
							<textarea class="form-control bold" style="height: 300px;" placeholder="{{ question.placeholder_text or '' }}" autocomplete="off" name="{{ question.name }}" data-fieldname="{{ question.name }}" data-question-type="{{ question.question_type }}"></textarea>
						{% elif question.question_type in ('MCQ', 'Multi Select') %}
							{% for option in question.options.split("\n") %}
								<label>
									<input type="{{ 'radio' if question.question_type == 'MCQ' else 'checkbox' }}" name="{{ question.name }}" data-fieldname="{{ question.name }}" data-question-type="{{ question.question_type }}" value="{{ option }}">
									{{ option }}
								</label>
								<br>
							{% endfor %}
						{% endif %}
					</div>
				</div>
			</div>
		</div>
 {% endmacro %}

{% block page_content %}
<h2>{{ title }}</h2>
<p>{{ description }}</p>
<hr>
<div role="form" class="container">
	<div class="job-test-form-wrapper">
		<form action="" id="jobTest" method="POST">
			{% for question in questions %}
				<div class="form-dashboard-section">
					<div class="section-head">
						{{ question.question }}
						{% if question.required %}
						<sup style="color: red;">*</sup>
						{% endif %}
					</div>
					<div class="section-body">
						{{ make_input(question) }}
					</div>
				</div>
			{% endfor %}
		</form>
		<button class='btn btn-primary' id="submitJobTest">{{ _("Submit") }}</button>
	</div>
</div>

{% endblock %}

{% block script %}
<script>
	frappe.provide("frappe.job_test");
	frappe.job_test.docname = "{{ docname }}"
	frappe.job_test.job_applicant = "{{ frappe.form_dict.job_applicant or ''}}"
	frappe.job_test.questions = {{ questions_json }}
</script>
<script type="text/javascript" src="/assets/frappe/js/lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="/assets/js/dialog.min.js"></script>
<script type="text/javascript" src="/assets/js/bootstrap-4-web.min.js"></script>
<script type="text/javascript" src="/assets/js/recruitment_ext.min.js"></script>
{% endblock %}